{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-mrhealth",
  "elements": [
    {"id":"title","type":"text","x":40,"y":20,"width":1200,"height":40,"text":"MR. HEALTH Data Platform - Arquitetura Completa","fontSize":32,"fontFamily":3,"strokeColor":"#1e1e1e"},
    {"id":"subtitle","type":"text","x":40,"y":65,"width":1400,"height":20,"text":"50 Unidades Restaurante | GCP Free Tier (R$0/mÃªs) | Medallion Architecture | Kimball Star Schema | Pipeline Orientado a Eventos | Apache Airflow + Superset","fontSize":14,"fontFamily":3,"strokeColor":"#868e96"},
    {"id":"divider","type":"line","x":40,"y":95,"width":1860,"height":0,"strokeColor":"#dee2e6","strokeWidth":2,"points":[[0,0],[1860,0]]},

    {"id":"z1_bg","type":"rectangle","x":40,"y":115,"width":300,"height":750,"strokeColor":"#4a5568","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"z1_lbl","type":"text","x":55,"y":125,"width":270,"height":24,"text":"[1] ON-PREMISE (Cluster K3s)","fontSize":18,"fontFamily":3,"strokeColor":"#4a5568"},

    {"id":"pg_box","type":"rectangle","x":55,"y":160,"width":270,"height":280,"strokeColor":"#336791","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pg_txt","type":"text","x":70,"y":175,"width":240,"height":250,"text":"POSTGRESQL 16-ALPINE\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nnamespace: mrhealth-db\nport: NodePort 30432\nrecursos:\n  memory: 128-256Mi\n  cpu: 100-250m\n\nTabelas de ReferÃªncia:\n  â”œâ”€ pais (1 registro)\n  â”œâ”€ estado (3: RS,SC,PR)\n  â”œâ”€ unidade (50 restaurantes)\n  â””â”€ produto (~200 itens)\n\nAcesso: SSH tunnel\nBackup: manual\nHA: single-node (dev)","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"pos_box","type":"rectangle","x":55,"y":460,"width":270,"height":180,"strokeColor":"#4a5568","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pos_txt","type":"text","x":70,"y":475,"width":240,"height":150,"text":"SISTEMAS POS (50 Unidades)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nRegiÃ£o: Sul do Brasil\n  RS, SC, PR\n\nArquivos CSV Gerados:\n  â”œâ”€ pedido.csv (pedidos)\n  â””â”€ item_pedido.csv (itens)\n\nVolume: ~100 arquivos/dia\nUpload: direto para GCS\nFormato: separado por ;","fontSize":11,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"ssh_box","type":"rectangle","x":55,"y":660,"width":270,"height":90,"strokeColor":"#4a5568","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roundness":{"type":3}},
    {"id":"ssh_txt","type":"text","x":70,"y":675,"width":240,"height":60,"text":"ACESSO VIA SSH TUNNEL\nprotocolo: SSH port-forward\nlocal:5432 â†’ remoto:30432\nauth: chave Ed25519/RSA","fontSize":11,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"z2_bg","type":"rectangle","x":360,"y":115,"width":820,"height":750,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"z2_lbl","type":"text","x":375,"y":125,"width":400,"height":24,"text":"[2] GCP CLOUD PLATFORM (Free Tier)","fontSize":18,"fontFamily":3,"strokeColor":"#4285f4"},

    {"id":"gcs_box","type":"rectangle","x":375,"y":160,"width":240,"height":230,"strokeColor":"#4285f4","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"gcs_txt","type":"text","x":390,"y":175,"width":210,"height":200,"text":"â˜ï¸ CLOUD STORAGE\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nbucket: mrhealth-datalake\n\nPrefixos:\n  raw/csv_sales/\n    â””â”€ YYYY/MM/DD/\n  raw/reference_data/\n  quarantine/\n\nGatilho: Eventarc\nClasse: STANDARD\nVersioning: habilitado","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"cf_box","type":"rectangle","x":635,"y":160,"width":280,"height":320,"strokeColor":"#4285f4","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"cf_txt","type":"text","x":650,"y":175,"width":250,"height":290,"text":"âš¡ CLOUD FUNCTIONS (3)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nruntime: Python 3.11\ngeraÃ§Ã£o: 2nd Gen\nmemÃ³ria: 256MB cada\n\n[1] csv-processor\n    gatilho: Eventarc (GCS)\n    prefixo: raw/csv_sales/\n    aÃ§Ã£o: validar â†’ BQ Bronze\n    timeout: 300s\n\n[2] data-generator\n    gatilho: HTTP (Scheduler)\n    agenda: 7x/dia\n    aÃ§Ã£o: Faker â†’ GCS CSV\n\n[3] pg-reference-extractor\n    gatilho: HTTP (Scheduler)\n    agenda: 01:00 BRT diÃ¡rio\n    aÃ§Ã£o: PG â†’ GCS via SSH\n    retry: 3x com backoff","fontSize":11,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"sch_box","type":"rectangle","x":935,"y":160,"width":230,"height":150,"strokeColor":"#4285f4","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"sch_txt","type":"text","x":950,"y":175,"width":200,"height":120,"text":"â° CLOUD SCHEDULER\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\njobs: 3 cron jobs\n\ndata-generator:\n  cron: 7x/dia\npg-extract:\n  cron: 01:00 BRT\npipeline-trigger:\n  cron: 02:00 BRT","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"sec_box","type":"rectangle","x":935,"y":330,"width":230,"height":120,"strokeColor":"#4285f4","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"sec_txt","type":"text","x":950,"y":345,"width":200,"height":90,"text":"ğŸ” SECRET MANAGER\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nsegredos:\n  pg-host, pg-ssh-user\n  pg-ssh-private-key\n  pg-db-name, pg-db-user\n  pg-db-password","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"bq_container","type":"rectangle","x":375,"y":500,"width":790,"height":350,"strokeColor":"#4285f4","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"bq_title","type":"text","x":390,"y":510,"width":760,"height":20,"text":"ğŸ“Š BIGQUERY - MEDALLION ARCHITECTURE                                                     localizaÃ§Ã£o: US | custo: Free Tier","fontSize":14,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"bronze_box","type":"rectangle","x":390,"y":540,"width":240,"height":295,"strokeColor":"#cd7f32","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"bronze_txt","type":"text","x":405,"y":555,"width":210,"height":265,"text":"ğŸ¥‰ CAMADA BRONZE\ncase_ficticio_bronze\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nTabelas (6):\n  orders\n  order_items\n  products\n  units\n  states\n  countries\n\nPartiÃ§Ã£o: _ingest_date\nFormato: append-only\nSLA: <5min apÃ³s upload\nQualidade: schema validado\nRetenÃ§Ã£o: permanente","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"silver_box","type":"rectangle","x":650,"y":540,"width":240,"height":295,"strokeColor":"#6b7280","backgroundColor":"#f3f4f6","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"silver_txt","type":"text","x":665,"y":555,"width":210,"height":265,"text":"ğŸ¥ˆ CAMADA SILVER\ncase_ficticio_silver\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nTabelas (6):\n  orders (limpo)\n  order_items (limpo)\n  products (ref)\n  units (ref)\n  states (ref)\n  countries (ref)\n\nPartiÃ§Ã£o: order_date\nCluster: unit_id\nTransform: MERGE+dedup\nQualidade: aplicada\nRetenÃ§Ã£o: permanente","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"gold_box","type":"rectangle","x":910,"y":540,"width":240,"height":295,"strokeColor":"#d97706","backgroundColor":"#fffbeb","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"gold_txt","type":"text","x":925,"y":555,"width":210,"height":265,"text":"ğŸ¥‡ CAMADA GOLD\ncase_ficticio_gold\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nDimensÃµes (4):\n  dim_date\n  dim_product\n  dim_unit\n  dim_geography\n\nFatos (2):\n  fact_sales\n  fact_order_items\n\nAgregaÃ§Ãµes (3):\n  agg_daily_sales\n  agg_unit_performance\n  agg_product_performance\n\nSchema: Kimball Star","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"z3_bg","type":"rectangle","x":1200,"y":115,"width":360,"height":750,"strokeColor":"#7c3aed","backgroundColor":"#f3e8ff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"z3_lbl","type":"text","x":1215,"y":125,"width":330,"height":24,"text":"[3] ORQUESTRAÃ‡ÃƒO & BI","fontSize":18,"fontFamily":3,"strokeColor":"#7c3aed"},

    {"id":"air_box","type":"rectangle","x":1215,"y":160,"width":330,"height":340,"strokeColor":"#7c3aed","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"air_txt","type":"text","x":1230,"y":175,"width":300,"height":310,"text":"ğŸŒ¬ï¸ APACHE AIRFLOW 2.8\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nplataforma: Docker Compose\nexecutor: LocalExecutor\nwebserver: porta 8080\ndb: PostgreSQL 15\n\nDAG: mrhealth_daily_pipeline\nagenda: 02:00 BRT diÃ¡rio\n\nTarefas (8):\n  [1] sense_new_files (sensor GCS)\n  [2] validate_bronze (check BQ)\n  [3] build_silver (SQL transforms)\n  [4] build_gold_dimensions (4 dims)\n  [5] build_gold_facts (2 fatos)\n  [6] build_aggregations (3 aggs)\n  [7] validate_gold (check BQ)\n  [8] notify_completion (resumo)\n\nretries: 2 | delay: 5min\ntimeout: 30min | catchup: false","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"sup_box","type":"rectangle","x":1215,"y":520,"width":330,"height":200,"strokeColor":"#7c3aed","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"sup_txt","type":"text","x":1230,"y":535,"width":300,"height":170,"text":"ğŸ“ˆ APACHE SUPERSET 3.1.1\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nplataforma: Docker Compose\nporta: 8088\nworkers: 2 (Gunicorn)\n\nConexÃ£o:\n  datasource: BigQuery (Gold)\n  auth: JSON service-account\n\nDashboards:\n  VisÃ£o Executiva\n  Dashboard Operacional\n  AnÃ¡lise Drill-Down\n\ngrÃ¡ficos: 12+ visualizaÃ§Ãµes","fontSize":11,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"look_box","type":"rectangle","x":1215,"y":740,"width":330,"height":110,"strokeColor":"#7c3aed","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"look_txt","type":"text","x":1230,"y":755,"width":300,"height":80,"text":"ğŸ“Š LOOKER STUDIO (Principal)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nconexÃ£o: BigQuery nativa\ndatasets: camada Gold\natualizaÃ§Ã£o: auto na query\ncusto: gratuito","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"z4_bg","type":"rectangle","x":1580,"y":115,"width":320,"height":750,"strokeColor":"#16a34a","backgroundColor":"#f0fdf4","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"z4_lbl","type":"text","x":1595,"y":125,"width":290,"height":24,"text":"[4] VALOR DE NEGÃ“CIO","fontSize":18,"fontFamily":3,"strokeColor":"#16a34a"},

    {"id":"kpi_box","type":"rectangle","x":1595,"y":160,"width":290,"height":250,"strokeColor":"#16a34a","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"kpi_txt","type":"text","x":1610,"y":175,"width":260,"height":220,"text":"ğŸ“ˆ INDICADORES CHAVE (KPIs)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nMÃ©tricas de Receita:\n  total_revenue (diÃ¡rio/semanal)\n  avg_ticket_value (por unidade)\n  revenue_by_category\n\nMÃ©tricas Operacionais:\n  total_orders (por perÃ­odo)\n  orders_per_unit (eficiÃªncia)\n  product_mix_analysis\n\nQualidade de Dados:\n  completude: >99%\n  zero duplicatas: 100%\n  freshness: D+0","fontSize":11,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"sla_box","type":"rectangle","x":1595,"y":430,"width":290,"height":200,"strokeColor":"#16a34a","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"sla_txt","type":"text","x":1610,"y":445,"width":260,"height":170,"text":"â±ï¸ FRESHNESS DE DADOS & SLA\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nANTES (Excel Manual):\n  LatÃªncia: D+1 a D+3\n  Tempo: 4-6h/dia\n  Taxa de erro: 2-5%\n\nDEPOIS (Esta Plataforma):\n  LatÃªncia: D+0 (<3 minutos)\n  Tempo: automatizado\n  Taxa de erro: ~0%\n\nAgenda do Pipeline:\n  Bronze: tempo real (evento)\n  Silver/Gold: 02:00-03:00 BRT","fontSize":12,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"cost_box","type":"rectangle","x":1595,"y":650,"width":290,"height":200,"strokeColor":"#16a34a","backgroundColor":"#ffffff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"cost_txt","type":"text","x":1610,"y":665,"width":260,"height":170,"text":"ğŸ’° OTIMIZAÃ‡ÃƒO DE CUSTO\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nCusto Mensal: R$0,00\n\nLimites GCP Free Tier:\n  GCS: 5GB armazenamento\n  BigQuery: 10GB + 1TB query\n  Cloud Functions: 2M chamadas\n  Cloud Scheduler: 3 jobs\n\nCobertura de Testes: 97.2%\nMeta Disponibilidade: >99%\n\nAutor: Arthur Graf\nEmpresa: DataLakers","fontSize":11,"fontFamily":3,"strokeColor":"#1e1e1e"},

    {"id":"footer","type":"text","x":40,"y":880,"width":1860,"height":16,"text":"MR. HEALTH Data Platform | DataLakers | Autor: Arthur Graf | Gerado: 2026-02 | Custo: R$0/mÃªs (GCP Free Tier) | Cobertura de Testes: 97.2%","fontSize":11,"fontFamily":3,"textAlign":"center","strokeColor":"#ced4da"}
  ],
  "appState": {"viewBackgroundColor":"#ffffff","gridSize":null},
  "files": {}
}
