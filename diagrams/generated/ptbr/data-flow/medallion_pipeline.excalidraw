{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-mrhealth",
  "elements": [
    {"id":"title","type":"text","x":40,"y":20,"width":800,"height":40,"text":"ğŸ”„ Medallion Architecture - Pipeline de Fluxo de Dados","fontSize":28,"fontFamily":3,"strokeColor":"#1864ab"},
    {"id":"subtitle","type":"text","x":40,"y":65,"width":800,"height":20,"text":"Bronze (Bruto) â†’ Silver (Limpo) â†’ Gold (NegÃ³cio) | IngestÃ£o Orientada a Eventos + OrquestraÃ§Ã£o DiÃ¡ria","fontSize":14,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"source1_box","type":"rectangle","x":40,"y":130,"width":180,"height":140,"strokeColor":"#495057","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"source1_title","type":"text","x":55,"y":145,"width":150,"height":22,"text":"ğŸ½ï¸ Sistemas POS","fontSize":14,"fontFamily":3,"strokeColor":"#495057"},
    {"id":"source1_content","type":"text","x":55,"y":175,"width":150,"height":85,"text":"50 Unidades Restaurante\nRegiÃ£o Sul (RS, SC, PR)\n\nCSVs Gerados:\nâ€¢ pedidos.csv\nâ€¢ itens_pedido.csv\n\n~100 arquivos/dia","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"source2_box","type":"rectangle","x":40,"y":290,"width":180,"height":140,"strokeColor":"#336791","backgroundColor":"#e8f4f8","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"source2_title","type":"text","x":55,"y":305,"width":150,"height":22,"text":"ğŸ˜ PostgreSQL","fontSize":14,"fontFamily":3,"strokeColor":"#336791"},
    {"id":"source2_content","type":"text","x":55,"y":335,"width":150,"height":85,"text":"Cluster K3s\nDados de ReferÃªncia:\nâ€¢ pais (1)\nâ€¢ estado (3)\nâ€¢ unidade (50)\nâ€¢ produto (~200)\n\nAcesso via SSH Tunnel","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_pos_gcs","type":"arrow","x":220,"y":200,"width":60,"height":0,"strokeColor":"#495057","strokeWidth":2,"points":[[0,0],[60,0]],"endArrowhead":"arrow"},
    {"id":"arrow_pg_gcs","type":"arrow","x":220,"y":360,"width":60,"height":-100,"strokeColor":"#336791","strokeWidth":2,"points":[[0,0],[30,-50],[60,-100]],"endArrowhead":"arrow"},

    {"id":"gcs_box","type":"rectangle","x":300,"y":130,"width":180,"height":180,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"gcs_title","type":"text","x":315,"y":145,"width":150,"height":22,"text":"â˜ï¸ Cloud Storage","fontSize":14,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"gcs_content","type":"text","x":315,"y":175,"width":150,"height":125,"text":"Data Lake\nBucket: dados-sales-*\n\nPrefixos:\nğŸ“ raw/csv_sales/\n   â””â”€ YYYY/MM/DD/\nğŸ“ raw/reference_data/\nğŸ“ quarantine/\n\nGatilho: Eventarc\nVersioning: habilitado","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gcs_cf","type":"arrow","x":480,"y":220,"width":40,"height":0,"strokeColor":"#4285f4","strokeWidth":2,"points":[[0,0],[40,0]],"endArrowhead":"arrow"},
    {"id":"eventarc_label","type":"text","x":480,"y":195,"width":50,"height":18,"text":"Eventarc","fontSize":10,"fontFamily":3,"strokeColor":"#4285f4"},

    {"id":"cf_box","type":"rectangle","x":540,"y":130,"width":180,"height":180,"strokeColor":"#f76707","backgroundColor":"#fff4e6","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"cf_title","type":"text","x":555,"y":145,"width":150,"height":22,"text":"âš¡ Cloud Functions","fontSize":14,"fontFamily":3,"strokeColor":"#f76707"},
    {"id":"cf_content","type":"text","x":555,"y":175,"width":150,"height":125,"text":"Python 3.11\n\nğŸ“¦ csv-processor\n   gatilho Eventarc\n   validaÃ§Ã£o PyArrow\n   â†’ BigQuery Bronze\n\nğŸ“¦ pg-reference-extractor\n   Cloud Scheduler\n   SSH Tunnel â†’ CSV\n   â†’ GCS reference/","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_cf_bronze","type":"arrow","x":720,"y":220,"width":60,"height":0,"strokeColor":"#f76707","strokeWidth":2,"points":[[0,0],[60,0]],"endArrowhead":"arrow"},

    {"id":"bronze_box","type":"rectangle","x":800,"y":100,"width":200,"height":250,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":3,"roundness":{"type":3}},
    {"id":"bronze_title","type":"text","x":815,"y":115,"width":170,"height":25,"text":"ğŸ¥‰ BRONZE","fontSize":18,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_subtitle","type":"text","x":815,"y":140,"width":170,"height":15,"text":"case_ficticio_bronze","fontSize":10,"fontFamily":3,"strokeColor":"#868e96"},
    {"id":"bronze_content","type":"text","x":815,"y":165,"width":170,"height":175,"text":"Bruto, Append-Only\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nTabelas (6):\n  ğŸ“‹ orders\n  ğŸ“‹ order_items\n  ğŸ“‹ products\n  ğŸ“‹ units\n  ğŸ“‹ states\n  ğŸ“‹ countries\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nPartiÃ§Ã£o: _ingest_date\nValidaÃ§Ã£o: PyArrow\nSLA: <5 min apÃ³s upload","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_bronze_silver","type":"arrow","x":1000,"y":225,"width":60,"height":0,"strokeColor":"#4263eb","strokeWidth":3,"points":[[0,0],[60,0]],"endArrowhead":"arrow"},
    {"id":"airflow_label1","type":"text","x":1005,"y":200,"width":50,"height":18,"text":"Airflow","fontSize":10,"fontFamily":3,"strokeColor":"#4263eb"},

    {"id":"silver_box","type":"rectangle","x":1080,"y":100,"width":200,"height":250,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":3,"roundness":{"type":3}},
    {"id":"silver_title","type":"text","x":1095,"y":115,"width":170,"height":25,"text":"ğŸ¥ˆ SILVER","fontSize":18,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_subtitle","type":"text","x":1095,"y":140,"width":170,"height":15,"text":"case_ficticio_silver","fontSize":10,"fontFamily":3,"strokeColor":"#868e96"},
    {"id":"silver_content","type":"text","x":1095,"y":165,"width":170,"height":175,"text":"Limpo, Deduplicado\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nTabelas (6):\n  ğŸ“‹ orders (limpo)\n  ğŸ“‹ order_items (calc)\n  ğŸ“‹ products\n  ğŸ“‹ units (denorm)\n  ğŸ“‹ states\n  ğŸ“‹ countries\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nTransforms: ROW_NUMBER\nValidaÃ§Ã£o FK: INNER JOIN\nAgenda: 02:30 BRT","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_silver_gold","type":"arrow","x":1280,"y":225,"width":60,"height":0,"strokeColor":"#e67700","strokeWidth":3,"points":[[0,0],[60,0]],"endArrowhead":"arrow"},
    {"id":"airflow_label2","type":"text","x":1285,"y":200,"width":50,"height":18,"text":"Airflow","fontSize":10,"fontFamily":3,"strokeColor":"#e67700"},

    {"id":"gold_box","type":"rectangle","x":1360,"y":100,"width":200,"height":250,"strokeColor":"#e67700","backgroundColor":"#fff9db","fillStyle":"solid","strokeWidth":3,"roundness":{"type":3}},
    {"id":"gold_title","type":"text","x":1375,"y":115,"width":170,"height":25,"text":"ğŸ¥‡ GOLD","fontSize":18,"fontFamily":3,"strokeColor":"#e67700"},
    {"id":"gold_subtitle","type":"text","x":1375,"y":140,"width":170,"height":15,"text":"case_ficticio_gold","fontSize":10,"fontFamily":3,"strokeColor":"#868e96"},
    {"id":"gold_content","type":"text","x":1375,"y":165,"width":170,"height":175,"text":"Star Schema (Kimball)\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nDimensÃµes (4):\n  ğŸ“… dim_date\n  ğŸ• dim_product\n  ğŸª dim_unit\n  ğŸŒ dim_geography\nFatos (2):\n  ğŸ’° fact_sales\n  ğŸ“¦ fact_order_items\nAgregaÃ§Ãµes (3):\n  ğŸ“ˆ agg_daily/unit/product\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nAgenda: 03:00 BRT","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gold_bi","type":"arrow","x":1560,"y":225,"width":60,"height":0,"strokeColor":"#7048e8","strokeWidth":2,"points":[[0,0],[60,0]],"endArrowhead":"arrow"},

    {"id":"bi_box","type":"rectangle","x":1640,"y":100,"width":180,"height":250,"strokeColor":"#7048e8","backgroundColor":"#f3f0ff","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"bi_title","type":"text","x":1655,"y":115,"width":150,"height":22,"text":"ğŸ“Š Business Intel","fontSize":14,"fontFamily":3,"strokeColor":"#7048e8"},
    {"id":"bi_content","type":"text","x":1655,"y":145,"width":150,"height":195,"text":"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“ˆ Looker Studio\n  Conector nativo BQ\n  AtualizaÃ§Ã£o auto\n  Custo: R$0\n\nğŸ”¥ Apache Superset\n  Docker: 3.1.1\n  SQL Lab\n  40+ tipos de grÃ¡fico\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nDashboards:\n  â€¢ VisÃ£o Executiva\n  â€¢ OperaÃ§Ãµes\n  â€¢ AnÃ¡lise de Produtos\n  â€¢ Performance Unidades","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"timeline_box","type":"rectangle","x":40,"y":450,"width":1780,"height":100,"strokeColor":"#087f5b","backgroundColor":"#e6fcf5","fillStyle":"solid","strokeWidth":2},
    {"id":"timeline_title","type":"text","x":60,"y":465,"width":200,"height":22,"text":"â±ï¸ Cronograma DiÃ¡rio do Pipeline (BRT)","fontSize":14,"fontFamily":3,"strokeColor":"#087f5b"},
    {"id":"timeline_content","type":"text","x":60,"y":495,"width":1740,"height":45,"text":"00:00-23:59  POS faz upload de CSVs (ao longo do dia)  â†’  Eventarc dispara csv-processor  â†’  Bronze carrega em <5 min\n01:00        pg-reference-extractor executa (Cloud Scheduler)  â†’  Dados de referÃªncia para GCS  â†’  Tabelas de referÃªncia Bronze\n02:30        Airflow: Bronze â†’ Silver (dedup, transform, validar FKs)  ~2 min\n03:00        Airflow: Silver â†’ Gold (dims, fatos, agregaÃ§Ãµes)  ~5 min  â†’  Dashboards atualizados atÃ© 03:10 BRT","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"metrics_box","type":"rectangle","x":40,"y":570,"width":600,"height":140,"strokeColor":"#c92a2a","backgroundColor":"#fff5f5","fillStyle":"solid","strokeWidth":2},
    {"id":"metrics_title","type":"text","x":60,"y":585,"width":200,"height":22,"text":"ğŸ“ˆ SLAs do Pipeline","fontSize":14,"fontFamily":3,"strokeColor":"#c92a2a"},
    {"id":"metrics_content","type":"text","x":60,"y":615,"width":560,"height":85,"text":"LatÃªncia End-to-End:    < 3 minutos (upload POS â†’ Bronze)     âœ… vs 4-6 horas manual\nFreshness de Dados:     D+0 (mesmo dia)                        âœ… vs D+1 a D+3 manual\nTaxa de Erro:           ~0% (validaÃ§Ã£o de schema)               âœ… vs 2-5% manual\nDisponibilidade:        >99% alvo                               âœ… resiliÃªncia orientada a eventos\nZero Duplicatas:        100% (dedup ROW_NUMBER)                 âœ… garantido pelo Silver","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"cost_box","type":"rectangle","x":660,"y":570,"width":500,"height":140,"strokeColor":"#2f9e44","backgroundColor":"#ebfbee","fillStyle":"solid","strokeWidth":2},
    {"id":"cost_title","type":"text","x":680,"y":585,"width":200,"height":22,"text":"ğŸ’° Estrutura de Custo (GCP Free Tier)","fontSize":14,"fontFamily":3,"strokeColor":"#2f9e44"},
    {"id":"cost_content","type":"text","x":680,"y":615,"width":460,"height":85,"text":"Cloud Storage:      5 GB grÃ¡tis/mÃªs     Usado: ~500 MB          R$0,00\nBigQuery Armaz.:    10 GB grÃ¡tis/mÃªs    Usado: ~2 GB            R$0,00\nBigQuery Queries:   1 TB grÃ¡tis/mÃªs     Usado: ~50 GB           R$0,00\nCloud Functions:    2M invocaÃ§Ãµes/mÃªs   Usado: ~3.000           R$0,00\nCloud Scheduler:    3 jobs grÃ¡tis/mÃªs   Usado: 2                R$0,00\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nCUSTO TOTAL MENSAL:                                             R$0,00","fontSize":10,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"volumes_box","type":"rectangle","x":1180,"y":570,"width":640,"height":140,"strokeColor":"#1864ab","backgroundColor":"#e7f5ff","fillStyle":"solid","strokeWidth":2},
    {"id":"volumes_title","type":"text","x":1200,"y":585,"width":200,"height":22,"text":"ğŸ“Š Volumes de Dados (DiÃ¡rio)","fontSize":14,"fontFamily":3,"strokeColor":"#1864ab"},
    {"id":"volumes_content","type":"text","x":1200,"y":615,"width":600,"height":85,"text":"Arquivos CSV Ingeridos:  ~100 arquivos/dia (2 por unidade Ã— 50 unidades)\nPedidos:                 ~5.000 pedidos/dia (100 por unidade)\nItens de Pedido:         ~15.000-25.000 itens/dia (3-5 por pedido)\nDados de ReferÃªncia:     ~255 registros total (estÃ¡vel, atualizado diariamente)\nCrescimento Bronze:      ~5 MB/dia â†’ ~150 MB/mÃªs\nAgregaÃ§Ãµes Gold:         ~1.000 linhas/tabela (queries rÃ¡pidas <1s)","fontSize":10,"fontFamily":3,"strokeColor":"#495057"}
  ],
  "appState": {"viewBackgroundColor":"#ffffff","gridSize":null},
  "files": {}
}
