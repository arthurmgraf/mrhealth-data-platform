{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-mrhealth",
  "elements": [
    {"id":"title","type":"text","x":40,"y":20,"width":1100,"height":40,"text":"üê≥ Docker Compose Stacks - Infraestrutura Local","fontSize":28,"fontFamily":3,"strokeColor":"#0db7ed"},
    {"id":"subtitle","type":"text","x":40,"y":65,"width":1100,"height":20,"text":"Orquestra√ß√£o Airflow + BI Superset | Configura√ß√µes prontas para Desenvolvimento & Produ√ß√£o","fontSize":14,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"airflow_stack","type":"rectangle","x":40,"y":120,"width":550,"height":550,"strokeColor":"#e67700","backgroundColor":"#fff9db","fillStyle":"solid","strokeWidth":3,"roundness":{"type":3}},
    {"id":"airflow_title","type":"text","x":60,"y":135,"width":510,"height":30,"text":"üå¨Ô∏è Stack Apache Airflow 2.8","fontSize":20,"fontFamily":3,"strokeColor":"#e67700"},
    {"id":"airflow_file","type":"text","x":60,"y":170,"width":510,"height":15,"text":"Arquivo: docker-compose-airflow.yml","fontSize":11,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"airflow_pg","type":"rectangle","x":60,"y":200,"width":240,"height":130,"strokeColor":"#336791","backgroundColor":"#e8f4f8","fillStyle":"solid","strokeWidth":2},
    {"id":"airflow_pg_title","type":"text","x":75,"y":210,"width":210,"height":20,"text":"üêò postgres (Metadados)","fontSize":13,"fontFamily":3,"strokeColor":"#336791"},
    {"id":"airflow_pg_content","type":"text","x":75,"y":235,"width":210,"height":85,"text":"Image: postgres:13\nDatabase: airflow\nUser: airflow\nPassword: airflow\nPorta: 5432 (interna)\nVolume: postgres-db-volume\nHealth: pg_isready","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"airflow_init","type":"rectangle","x":320,"y":200,"width":250,"height":130,"strokeColor":"#087f5b","backgroundColor":"#e6fcf5","fillStyle":"solid","strokeWidth":2},
    {"id":"airflow_init_title","type":"text","x":335,"y":210,"width":220,"height":20,"text":"üîß airflow-init","fontSize":13,"fontFamily":3,"strokeColor":"#087f5b"},
    {"id":"airflow_init_content","type":"text","x":335,"y":235,"width":220,"height":85,"text":"Executa uma vez no startup\nTarefas:\n  ‚Ä¢ Criar usu√°rio admin\n  ‚Ä¢ Inicializar banco de dados\n  ‚Ä¢ Configurar conex√µes\nDepende: postgres healthy\nComando: airflow db init","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"airflow_web","type":"rectangle","x":60,"y":350,"width":240,"height":150,"strokeColor":"#f76707","backgroundColor":"#fff4e6","fillStyle":"solid","strokeWidth":2},
    {"id":"airflow_web_title","type":"text","x":75,"y":360,"width":210,"height":20,"text":"üåê airflow-webserver","fontSize":13,"fontFamily":3,"strokeColor":"#f76707"},
    {"id":"airflow_web_content","type":"text","x":75,"y":385,"width":210,"height":105,"text":"Image: apache/airflow:2.8-python3.11\nPorta: 8080:8080\nComando: webserver\nHealth: curl localhost:8080/health\nDepende: airflow-init\n\nAcesso UI:\n  http://localhost:8080\n  admin / admin","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"airflow_sched","type":"rectangle","x":320,"y":350,"width":250,"height":150,"strokeColor":"#7048e8","backgroundColor":"#f3f0ff","fillStyle":"solid","strokeWidth":2},
    {"id":"airflow_sched_title","type":"text","x":335,"y":360,"width":220,"height":20,"text":"‚è∞ airflow-scheduler","fontSize":13,"fontFamily":3,"strokeColor":"#7048e8"},
    {"id":"airflow_sched_content","type":"text","x":335,"y":385,"width":220,"height":105,"text":"Image: apache/airflow:2.8-python3.11\nComando: scheduler\nDepende: airflow-init\n\nResponsabilidades:\n  ‚Ä¢ Parsear arquivos DAG\n  ‚Ä¢ Agendar execu√ß√£o de tarefas\n  ‚Ä¢ Disparar sensors\n  ‚Ä¢ Atualizar estados das tarefas\n\nExecutor: LocalExecutor","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"airflow_volumes","type":"rectangle","x":60,"y":520,"width":510,"height":65,"strokeColor":"#495057","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":1},
    {"id":"airflow_volumes_title","type":"text","x":75,"y":530,"width":200,"height":18,"text":"üìÅ Volumes Montados","fontSize":11,"fontFamily":3,"strokeColor":"#495057"},
    {"id":"airflow_volumes_content","type":"text","x":75,"y":550,"width":480,"height":30,"text":"./dags:/opt/airflow/dags | ./logs:/opt/airflow/logs | ./config:/opt/airflow/config\n./scripts:/opt/airflow/scripts | ./sql:/opt/airflow/sql","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"airflow_env","type":"rectangle","x":60,"y":600,"width":510,"height":55,"strokeColor":"#1971c2","backgroundColor":"#e7f5ff","fillStyle":"solid","strokeWidth":1},
    {"id":"airflow_env_title","type":"text","x":75,"y":608,"width":200,"height":18,"text":"üîê Vari√°veis de Ambiente","fontSize":11,"fontFamily":3,"strokeColor":"#1971c2"},
    {"id":"airflow_env_content","type":"text","x":75,"y":628,"width":480,"height":20,"text":"AIRFLOW__CORE__EXECUTOR=LocalExecutor | AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://... | GCP_PROJECT_ID, GCS_BUCKET_NAME","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_stack","type":"rectangle","x":620,"y":120,"width":550,"height":550,"strokeColor":"#1971c2","backgroundColor":"#e7f5ff","fillStyle":"solid","strokeWidth":3,"roundness":{"type":3}},
    {"id":"superset_title","type":"text","x":640,"y":135,"width":510,"height":30,"text":"üî• Stack Apache Superset 3.1.1","fontSize":20,"fontFamily":3,"strokeColor":"#1971c2"},
    {"id":"superset_file","type":"text","x":640,"y":170,"width":510,"height":15,"text":"Arquivo: docker-compose-superset.yml","fontSize":11,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"superset_app","type":"rectangle","x":640,"y":200,"width":250,"height":180,"strokeColor":"#f76707","backgroundColor":"#fff4e6","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_app_title","type":"text","x":655,"y":210,"width":220,"height":20,"text":"üìä superset (App Principal)","fontSize":13,"fontFamily":3,"strokeColor":"#f76707"},
    {"id":"superset_app_content","type":"text","x":655,"y":235,"width":220,"height":135,"text":"Image: apache/superset:3.1.1\nPorta: 8088:8088\nWorkers: 4 (Gunicorn)\n\nFuncionalidades:\n  ‚Ä¢ SQL Lab (queries ad-hoc)\n  ‚Ä¢ 40+ tipos de gr√°ficos\n  ‚Ä¢ Construtor de dashboards\n  ‚Ä¢ Controle de acesso por role\n  ‚Ä¢ Alertas & relat√≥rios\n\nAuth: OAuth2 / LDAP pronto\nUI: http://localhost:8088","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_init","type":"rectangle","x":910,"y":200,"width":240,"height":180,"strokeColor":"#087f5b","backgroundColor":"#e6fcf5","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_init_title","type":"text","x":925,"y":210,"width":210,"height":20,"text":"üîß superset-init","fontSize":13,"fontFamily":3,"strokeColor":"#087f5b"},
    {"id":"superset_init_content","type":"text","x":925,"y":235,"width":210,"height":135,"text":"Tarefas de inicializa√ß√£o:\n\n1. superset db upgrade\n2. superset fab create-admin\n   --username admin\n   --password admin\n3. superset init\n4. superset load_examples\n\nExecuta uma vez no primeiro startup\nComando: /app/docker/init.sh","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_redis","type":"rectangle","x":640,"y":400,"width":250,"height":100,"strokeColor":"#c92a2a","backgroundColor":"#fff5f5","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_redis_title","type":"text","x":655,"y":410,"width":220,"height":20,"text":"üì¶ redis (Cache)","fontSize":13,"fontFamily":3,"strokeColor":"#c92a2a"},
    {"id":"superset_redis_content","type":"text","x":655,"y":435,"width":220,"height":55,"text":"Image: redis:7-alpine\nPorta: 6379 (interna)\n\nUso: Cache de dashboards\nBackend de resultado para Celery (se habilitado)","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_bq","type":"rectangle","x":910,"y":400,"width":240,"height":100,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_bq_title","type":"text","x":925,"y":410,"width":210,"height":20,"text":"üîó Conex√£o BigQuery","fontSize":13,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"superset_bq_content","type":"text","x":925,"y":435,"width":210,"height":55,"text":"SQLAlchemy URI:\nbigquery://project/dataset\n\nAuth: JSON Service Account\nDatasets: case_ficticio_gold","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_config","type":"rectangle","x":640,"y":520,"width":510,"height":65,"strokeColor":"#495057","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":1},
    {"id":"superset_config_title","type":"text","x":655,"y":530,"width":200,"height":18,"text":"‚öôÔ∏è Configura√ß√£o","fontSize":11,"fontFamily":3,"strokeColor":"#495057"},
    {"id":"superset_config_content","type":"text","x":655,"y":550,"width":480,"height":30,"text":"superset_config.py: SECRET_KEY, SQLALCHEMY_DATABASE_URI, WTF_CSRF_ENABLED\nFeature Flags: ENABLE_TEMPLATE_PROCESSING, DASHBOARD_NATIVE_FILTERS","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_volumes","type":"rectangle","x":640,"y":600,"width":510,"height":55,"strokeColor":"#1971c2","backgroundColor":"#fff","fillStyle":"solid","strokeWidth":1},
    {"id":"superset_volumes_title","type":"text","x":655,"y":608,"width":200,"height":18,"text":"üìÅ Volumes","fontSize":11,"fontFamily":3,"strokeColor":"#1971c2"},
    {"id":"superset_volumes_content","type":"text","x":655,"y":628,"width":480,"height":20,"text":"./superset:/app/superset_home | ./superset/superset_config.py:/app/superset_config.py","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"commands_box","type":"rectangle","x":40,"y":700,"width":1130,"height":100,"strokeColor":"#2f9e44","backgroundColor":"#ebfbee","fillStyle":"solid","strokeWidth":2},
    {"id":"commands_title","type":"text","x":60,"y":715,"width":200,"height":22,"text":"üöÄ Comandos R√°pidos","fontSize":14,"fontFamily":3,"strokeColor":"#2f9e44"},
    {"id":"commands_content","type":"text","x":60,"y":745,"width":1090,"height":45,"text":"# Iniciar stack Airflow                                  # Iniciar stack Superset\ndocker compose -f docker-compose-airflow.yml up -d       docker compose -f docker-compose-superset.yml up -d\n\n# Ver logs                                               # Parar tudo\ndocker compose -f docker-compose-airflow.yml logs -f     docker compose -f docker-compose-*.yml down","fontSize":10,"fontFamily":3,"strokeColor":"#495057"}
  ],
  "appState": {"viewBackgroundColor":"#ffffff","gridSize":null},
  "files": {}
}
