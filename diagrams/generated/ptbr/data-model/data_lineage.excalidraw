{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-mrhealth",
  "elements": [
    {"id":"title","type":"text","x":40,"y":20,"width":1400,"height":40,"text":"Data Lineage - Da Origem ao Dashboard","fontSize":28,"fontFamily":3,"strokeColor":"#1864ab"},
    {"id":"subtitle","type":"text","x":40,"y":65,"width":1400,"height":20,"text":"Jornada completa dos dados desde sistemas POS até dashboards executivos com detalhes de transformação em cada etapa","fontSize":14,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"source_section","type":"text","x":40,"y":110,"width":200,"height":25,"text":"FONTES DE DADOS","fontSize":16,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"pos_box","type":"rectangle","x":40,"y":145,"width":200,"height":100,"strokeColor":"#495057","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pos_title","type":"text","x":55,"y":155,"width":170,"height":18,"text":"Sistemas POS","fontSize":12,"fontFamily":3,"strokeColor":"#495057"},
    {"id":"pos_content","type":"text","x":55,"y":178,"width":170,"height":60,"text":"50 Unidades Restaurante\nExports CSV:\n  • pedidos.csv\n  • itens_pedido.csv\nFrequência: Diária","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"pg_box","type":"rectangle","x":40,"y":260,"width":200,"height":100,"strokeColor":"#336791","backgroundColor":"#e8f4f8","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pg_title","type":"text","x":55,"y":270,"width":170,"height":18,"text":"PostgreSQL","fontSize":12,"fontFamily":3,"strokeColor":"#336791"},
    {"id":"pg_content","type":"text","x":55,"y":293,"width":170,"height":60,"text":"Dados de Referência:\n  • pais (1 linha)\n  • estado (3 linhas)\n  • unidade (50 linhas)\n  • produto (~200 linhas)","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_pos_gcs","type":"arrow","x":240,"y":195,"width":70,"height":0,"strokeColor":"#495057","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"arrow_pg_gcs","type":"arrow","x":240,"y":310,"width":70,"height":-80,"strokeColor":"#336791","strokeWidth":2,"points":[[0,0],[35,-40],[70,-80]],"endArrowhead":"arrow"},

    {"id":"staging_section","type":"text","x":330,"y":110,"width":200,"height":25,"text":"STAGING","fontSize":16,"fontFamily":3,"strokeColor":"#4285f4"},

    {"id":"gcs_box","type":"rectangle","x":330,"y":145,"width":200,"height":140,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"gcs_title","type":"text","x":345,"y":155,"width":170,"height":18,"text":"Cloud Storage","fontSize":12,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"gcs_content","type":"text","x":345,"y":178,"width":170,"height":100,"text":"Bucket: dados-sales-*\n\nraw/csv_sales/\n  └─ YYYY/MM/DD/*.csv\n\nraw/reference_data/\n  └─ {tabela}.csv\n\nquarantine/\n  └─ arquivos inválidos","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gcs_bronze","type":"arrow","x":530,"y":215,"width":70,"height":0,"strokeColor":"#f76707","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform1","type":"text","x":535,"y":190,"width":60,"height":45,"text":"csv-processor\nPyArrow\nvalidação","fontSize":8,"fontFamily":3,"strokeColor":"#f76707"},

    {"id":"bronze_section","type":"text","x":620,"y":110,"width":200,"height":25,"text":"BRONZE","fontSize":16,"fontFamily":3,"strokeColor":"#9c6644"},

    {"id":"bronze_orders","type":"rectangle","x":620,"y":145,"width":180,"height":70,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_orders_title","type":"text","x":635,"y":155,"width":150,"height":15,"text":"orders","fontSize":11,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_orders_cols","type":"text","x":635,"y":173,"width":150,"height":35,"text":"id_pedido, id_unidade\ntipo_pedido, status_pedido\nvalor_pedido, taxa_entrega, dt_pedido","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"bronze_items","type":"rectangle","x":620,"y":225,"width":180,"height":60,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_items_title","type":"text","x":635,"y":235,"width":150,"height":15,"text":"order_items","fontSize":11,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_items_cols","type":"text","x":635,"y":253,"width":150,"height":25,"text":"id_item_pedido, id_pedido\nid_produto, qtd, vlr_item","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"bronze_ref","type":"rectangle","x":620,"y":295,"width":180,"height":60,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_ref_title","type":"text","x":635,"y":305,"width":150,"height":15,"text":"products, units, states, countries","fontSize":10,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_ref_cols","type":"text","x":635,"y":323,"width":150,"height":25,"text":"Dados de referência da\nextração PostgreSQL","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_bronze_silver","type":"arrow","x":800,"y":215,"width":70,"height":0,"strokeColor":"#4263eb","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform2","type":"text","x":805,"y":180,"width":60,"height":60,"text":"Airflow\nROW_NUMBER\nCAST\nTRIM\nINNER JOIN","fontSize":8,"fontFamily":3,"strokeColor":"#4263eb"},

    {"id":"silver_section","type":"text","x":890,"y":110,"width":200,"height":25,"text":"SILVER","fontSize":16,"fontFamily":3,"strokeColor":"#4263eb"},

    {"id":"silver_orders","type":"rectangle","x":890,"y":145,"width":180,"height":70,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_orders_title","type":"text","x":905,"y":155,"width":150,"height":15,"text":"orders (limpo)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_orders_cols","type":"text","x":905,"y":173,"width":150,"height":35,"text":"order_id, unit_id (FK validado)\norder_type (UPPER), order_status\norder_value (ROUND), total_items","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"silver_items","type":"rectangle","x":890,"y":225,"width":180,"height":60,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_items_title","type":"text","x":905,"y":235,"width":150,"height":15,"text":"order_items (limpo)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_items_cols","type":"text","x":905,"y":253,"width":150,"height":25,"text":"order_item_id, order_id (FK)\nquantity (INT), total_item_value (calc)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"silver_units","type":"rectangle","x":890,"y":295,"width":180,"height":60,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_units_title","type":"text","x":905,"y":305,"width":150,"height":15,"text":"units (desnormalizado)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_units_cols","type":"text","x":905,"y":323,"width":150,"height":25,"text":"unit_id, unit_name\nstate_name, country_name (JOINed)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_silver_gold","type":"arrow","x":1070,"y":215,"width":70,"height":0,"strokeColor":"#e67700","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform3","type":"text","x":1075,"y":185,"width":60,"height":50,"text":"Airflow\nKimball\nStar Schema\nConform Dims","fontSize":8,"fontFamily":3,"strokeColor":"#e67700"},

    {"id":"gold_section","type":"text","x":1160,"y":110,"width":200,"height":25,"text":"GOLD","fontSize":16,"fontFamily":3,"strokeColor":"#e67700"},

    {"id":"gold_dims","type":"rectangle","x":1160,"y":145,"width":180,"height":90,"strokeColor":"#2f9e44","backgroundColor":"#ebfbee","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_dims_title","type":"text","x":1175,"y":155,"width":150,"height":15,"text":"Dimensões (4)","fontSize":11,"fontFamily":3,"strokeColor":"#2f9e44"},
    {"id":"gold_dims_cols","type":"text","x":1175,"y":173,"width":150,"height":55,"text":"dim_date (hierarquia de datas)\ndim_product (pronto SCD2)\ndim_unit (geografia denorm)\ndim_geography (estado/país)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"gold_facts","type":"rectangle","x":1160,"y":245,"width":180,"height":70,"strokeColor":"#c92a2a","backgroundColor":"#fff5f5","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_facts_title","type":"text","x":1175,"y":255,"width":150,"height":15,"text":"Fatos (2)","fontSize":11,"fontFamily":3,"strokeColor":"#c92a2a"},
    {"id":"gold_facts_cols","type":"text","x":1175,"y":273,"width":150,"height":35,"text":"fact_sales (grão pedido)\nfact_order_items (grão item)\nParticionado + Clusterizado","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"gold_aggs","type":"rectangle","x":1160,"y":325,"width":180,"height":60,"strokeColor":"#7048e8","backgroundColor":"#f3f0ff","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_aggs_title","type":"text","x":1175,"y":335,"width":150,"height":15,"text":"Agregações (3)","fontSize":11,"fontFamily":3,"strokeColor":"#7048e8"},
    {"id":"gold_aggs_cols","type":"text","x":1175,"y":353,"width":150,"height":25,"text":"agg_daily_sales\nagg_unit_perf, agg_product_perf","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gold_bi","type":"arrow","x":1340,"y":260,"width":70,"height":0,"strokeColor":"#7048e8","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},

    {"id":"bi_section","type":"text","x":1430,"y":110,"width":200,"height":25,"text":"CAMADA BI","fontSize":16,"fontFamily":3,"strokeColor":"#7048e8"},

    {"id":"looker_box","type":"rectangle","x":1430,"y":145,"width":180,"height":100,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2},
    {"id":"looker_title","type":"text","x":1445,"y":155,"width":150,"height":15,"text":"Looker Studio","fontSize":11,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"looker_content","type":"text","x":1445,"y":175,"width":150,"height":65,"text":"Dashboards:\n• Visão Executiva\n• Tendências de Receita Diária\n• Performance por Unidade\n• Análise de Produtos\n\nConexão: BigQuery Nativa","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_box","type":"rectangle","x":1430,"y":260,"width":180,"height":100,"strokeColor":"#f76707","backgroundColor":"#fff4e6","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_title","type":"text","x":1445,"y":270,"width":150,"height":15,"text":"Apache Superset","fontSize":11,"fontFamily":3,"strokeColor":"#f76707"},
    {"id":"superset_content","type":"text","x":1445,"y":290,"width":150,"height":65,"text":"Funcionalidades:\n• SQL Lab (ad-hoc)\n• Gráficos avançados\n• Cross-filtering\n• Relatórios agendados\n\nConexão: SQLAlchemy BQ","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"metrics_section","type":"rectangle","x":40,"y":400,"width":1570,"height":130,"strokeColor":"#087f5b","backgroundColor":"#e6fcf5","fillStyle":"solid","strokeWidth":2},
    {"id":"metrics_title","type":"text","x":60,"y":415,"width":300,"height":22,"text":"Métricas de Qualidade de Dados & Lineage","fontSize":14,"fontFamily":3,"strokeColor":"#087f5b"},
    {"id":"metrics_content","type":"text","x":60,"y":445,"width":1530,"height":75,"text":"Camada          │ Tabelas │ Linhas/Dia  │ Latência     │ Verificações de Qualidade                   │ Atualização\n────────────────┼─────────┼─────────────┼──────────────┼─────────────────────────────────────────────┼──────────────\nBronze          │ 6       │ ~20.000     │ <5 min       │ Validação schema PyArrow                    │ Orientado a eventos\nSilver          │ 6       │ ~20.000     │ +2 min       │ ROW_NUMBER dedup, validação FK INNER JOIN   │ 02:30 BRT diário\nGold            │ 9       │ ~20.000     │ +5 min       │ Row counts > 0, integridade referencial     │ 03:00 BRT diário\n────────────────┴─────────┴─────────────┴──────────────┴─────────────────────────────────────────────┴──────────────\nSLA End-to-End: Upload POS → Atualização Dashboard < 8 horas (batch noturno) ou < 5 min (evento intraday)","fontSize":9,"fontFamily":3,"strokeColor":"#495057"}
  ],
  "appState": {"viewBackgroundColor":"#ffffff","gridSize":null},
  "files": {}
}
