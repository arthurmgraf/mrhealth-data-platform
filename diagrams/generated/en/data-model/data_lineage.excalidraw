{
  "type": "excalidraw",
  "version": 2,
  "source": "claude-code-mrhealth",
  "elements": [
    {"id":"pg_logo","type":"image","x":40,"y":260,"width":30,"height":30,"status":"saved","fileId":"postgresql_logo","scale":[1,1]},
    {"id":"bq_logo","type":"image","x":620,"y":110,"width":30,"height":30,"status":"saved","fileId":"bigquery_logo","scale":[1,1]},
    {"id":"title","type":"text","x":40,"y":20,"width":1400,"height":40,"text":"Data Lineage - Source to Dashboard","fontSize":28,"fontFamily":3,"strokeColor":"#1864ab"},
    {"id":"subtitle","type":"text","x":40,"y":65,"width":1400,"height":20,"text":"Complete data journey from POS systems to executive dashboards with transformation details at each step","fontSize":14,"fontFamily":3,"strokeColor":"#868e96"},

    {"id":"source_section","type":"text","x":40,"y":110,"width":200,"height":25,"text":"DATA SOURCES","fontSize":16,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"pos_box","type":"rectangle","x":40,"y":145,"width":200,"height":100,"strokeColor":"#495057","backgroundColor":"#f8f9fa","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pos_title","type":"text","x":55,"y":155,"width":170,"height":18,"text":"POS Systems","fontSize":12,"fontFamily":3,"strokeColor":"#495057"},
    {"id":"pos_content","type":"text","x":55,"y":178,"width":170,"height":60,"text":"50 Restaurant Units\nCSV exports:\n  - pedidos.csv\n  - itens_pedido.csv\nFrequency: Daily","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"pg_box","type":"rectangle","x":40,"y":260,"width":200,"height":100,"strokeColor":"#4169E1","backgroundColor":"#e8f4f8","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"pg_title","type":"text","x":75,"y":270,"width":155,"height":18,"text":"PostgreSQL","fontSize":12,"fontFamily":3,"strokeColor":"#4169E1"},
    {"id":"pg_content","type":"text","x":55,"y":293,"width":170,"height":60,"text":"Reference Data:\n  - pais (1 row)\n  - estado (3 rows)\n  - unidade (50 rows)\n  - produto (~200 rows)","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_pos_gcs","type":"arrow","x":240,"y":195,"width":70,"height":0,"strokeColor":"#495057","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"arrow_pg_gcs","type":"arrow","x":240,"y":310,"width":70,"height":-80,"strokeColor":"#4169E1","strokeWidth":2,"points":[[0,0],[35,-40],[70,-80]],"endArrowhead":"arrow"},

    {"id":"staging_section","type":"text","x":330,"y":110,"width":200,"height":25,"text":"STAGING","fontSize":16,"fontFamily":3,"strokeColor":"#4285f4"},

    {"id":"gcs_box","type":"rectangle","x":330,"y":145,"width":200,"height":140,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2,"roundness":{"type":3}},
    {"id":"gcs_title","type":"text","x":345,"y":155,"width":170,"height":18,"text":"Cloud Storage","fontSize":12,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"gcs_content","type":"text","x":345,"y":178,"width":170,"height":100,"text":"Bucket: dados-sales-*\n\nraw/csv_sales/\n  - YYYY/MM/DD/*.csv\n\nraw/reference_data/\n  - {table}.csv\n\nquarantine/\n  - invalid files","fontSize":9,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gcs_bronze","type":"arrow","x":530,"y":215,"width":70,"height":0,"strokeColor":"#f76707","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform1","type":"text","x":535,"y":190,"width":60,"height":45,"text":"csv-processor\nPyArrow\nvalidation","fontSize":8,"fontFamily":3,"strokeColor":"#f76707"},

    {"id":"bronze_section","type":"text","x":655,"y":110,"width":200,"height":25,"text":"BRONZE","fontSize":16,"fontFamily":3,"strokeColor":"#9c6644"},

    {"id":"bronze_orders","type":"rectangle","x":620,"y":145,"width":180,"height":70,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_orders_title","type":"text","x":635,"y":155,"width":150,"height":15,"text":"orders","fontSize":11,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_orders_cols","type":"text","x":635,"y":173,"width":150,"height":35,"text":"id_pedido, id_unidade\ntipo_pedido, status_pedido\nvalor_pedido, taxa_entrega, dt_pedido","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"bronze_items","type":"rectangle","x":620,"y":225,"width":180,"height":60,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_items_title","type":"text","x":635,"y":235,"width":150,"height":15,"text":"order_items","fontSize":11,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_items_cols","type":"text","x":635,"y":253,"width":150,"height":25,"text":"id_item_pedido, id_pedido\nid_produto, qtd, vlr_item","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"bronze_ref","type":"rectangle","x":620,"y":295,"width":180,"height":60,"strokeColor":"#9c6644","backgroundColor":"#fef3c7","fillStyle":"solid","strokeWidth":2},
    {"id":"bronze_ref_title","type":"text","x":635,"y":305,"width":150,"height":15,"text":"products, units, states, countries","fontSize":10,"fontFamily":3,"strokeColor":"#9c6644"},
    {"id":"bronze_ref_cols","type":"text","x":635,"y":323,"width":150,"height":25,"text":"Reference data from\nPostgreSQL extraction","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_bronze_silver","type":"arrow","x":800,"y":215,"width":70,"height":0,"strokeColor":"#4263eb","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform2","type":"text","x":805,"y":180,"width":60,"height":60,"text":"Airflow\nROW_NUMBER\nCAST\nTRIM\nINNER JOIN","fontSize":8,"fontFamily":3,"strokeColor":"#4263eb"},

    {"id":"silver_section","type":"text","x":890,"y":110,"width":200,"height":25,"text":"SILVER","fontSize":16,"fontFamily":3,"strokeColor":"#4263eb"},

    {"id":"silver_orders","type":"rectangle","x":890,"y":145,"width":180,"height":70,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_orders_title","type":"text","x":905,"y":155,"width":150,"height":15,"text":"orders (cleaned)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_orders_cols","type":"text","x":905,"y":173,"width":150,"height":35,"text":"order_id, unit_id (FK validated)\norder_type (UPPER), order_status\norder_value (ROUND), total_items","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"silver_items","type":"rectangle","x":890,"y":225,"width":180,"height":60,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_items_title","type":"text","x":905,"y":235,"width":150,"height":15,"text":"order_items (cleaned)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_items_cols","type":"text","x":905,"y":253,"width":150,"height":25,"text":"order_item_id, order_id (FK)\nquantity (INT), total_item_value (calc)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"silver_units","type":"rectangle","x":890,"y":295,"width":180,"height":60,"strokeColor":"#4263eb","backgroundColor":"#edf2ff","fillStyle":"solid","strokeWidth":2},
    {"id":"silver_units_title","type":"text","x":905,"y":305,"width":150,"height":15,"text":"units (denormalized)","fontSize":11,"fontFamily":3,"strokeColor":"#4263eb"},
    {"id":"silver_units_cols","type":"text","x":905,"y":323,"width":150,"height":25,"text":"unit_id, unit_name\nstate_name, country_name (JOINed)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_silver_gold","type":"arrow","x":1070,"y":215,"width":70,"height":0,"strokeColor":"#e67700","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},
    {"id":"transform3","type":"text","x":1075,"y":185,"width":60,"height":50,"text":"Airflow\nKimball\nStar Schema\nConform Dims","fontSize":8,"fontFamily":3,"strokeColor":"#e67700"},

    {"id":"gold_section","type":"text","x":1160,"y":110,"width":200,"height":25,"text":"GOLD","fontSize":16,"fontFamily":3,"strokeColor":"#e67700"},

    {"id":"gold_dims","type":"rectangle","x":1160,"y":145,"width":180,"height":90,"strokeColor":"#2f9e44","backgroundColor":"#ebfbee","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_dims_title","type":"text","x":1175,"y":155,"width":150,"height":15,"text":"Dimensions (4)","fontSize":11,"fontFamily":3,"strokeColor":"#2f9e44"},
    {"id":"gold_dims_cols","type":"text","x":1175,"y":173,"width":150,"height":55,"text":"dim_date (date hierarchy)\ndim_product (SCD2 ready)\ndim_unit (geography denorm)\ndim_geography (state/country)","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"gold_facts","type":"rectangle","x":1160,"y":245,"width":180,"height":70,"strokeColor":"#c92a2a","backgroundColor":"#fff5f5","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_facts_title","type":"text","x":1175,"y":255,"width":150,"height":15,"text":"Facts (2)","fontSize":11,"fontFamily":3,"strokeColor":"#c92a2a"},
    {"id":"gold_facts_cols","type":"text","x":1175,"y":273,"width":150,"height":35,"text":"fact_sales (order grain)\nfact_order_items (line grain)\nPartitioned + Clustered","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"gold_aggs","type":"rectangle","x":1160,"y":325,"width":180,"height":60,"strokeColor":"#7048e8","backgroundColor":"#f3f0ff","fillStyle":"solid","strokeWidth":2},
    {"id":"gold_aggs_title","type":"text","x":1175,"y":335,"width":150,"height":15,"text":"Aggregations (3)","fontSize":11,"fontFamily":3,"strokeColor":"#7048e8"},
    {"id":"gold_aggs_cols","type":"text","x":1175,"y":353,"width":150,"height":25,"text":"agg_daily_sales\nagg_unit_perf, agg_product_perf","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"arrow_gold_bi","type":"arrow","x":1340,"y":260,"width":70,"height":0,"strokeColor":"#7048e8","strokeWidth":2,"points":[[0,0],[70,0]],"endArrowhead":"arrow"},

    {"id":"bi_section","type":"text","x":1430,"y":110,"width":200,"height":25,"text":"BI LAYER","fontSize":16,"fontFamily":3,"strokeColor":"#7048e8"},

    {"id":"looker_box","type":"rectangle","x":1430,"y":145,"width":180,"height":100,"strokeColor":"#4285f4","backgroundColor":"#e8f0fe","fillStyle":"solid","strokeWidth":2},
    {"id":"looker_title","type":"text","x":1445,"y":155,"width":150,"height":15,"text":"Looker Studio","fontSize":11,"fontFamily":3,"strokeColor":"#4285f4"},
    {"id":"looker_content","type":"text","x":1445,"y":175,"width":150,"height":65,"text":"Dashboards:\n- Executive Overview\n- Daily Revenue Trends\n- Unit Performance\n- Product Analysis\n\nConnection: Native BigQuery","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"superset_box","type":"rectangle","x":1430,"y":260,"width":180,"height":100,"strokeColor":"#f76707","backgroundColor":"#fff4e6","fillStyle":"solid","strokeWidth":2},
    {"id":"superset_title","type":"text","x":1445,"y":270,"width":150,"height":15,"text":"Apache Superset","fontSize":11,"fontFamily":3,"strokeColor":"#f76707"},
    {"id":"superset_content","type":"text","x":1445,"y":290,"width":150,"height":65,"text":"Features:\n- SQL Lab (ad-hoc)\n- Advanced charts\n- Cross-filtering\n- Scheduled reports\n\nConnection: SQLAlchemy BQ","fontSize":8,"fontFamily":3,"strokeColor":"#495057"},

    {"id":"metrics_section","type":"rectangle","x":40,"y":400,"width":1570,"height":130,"strokeColor":"#087f5b","backgroundColor":"#e6fcf5","fillStyle":"solid","strokeWidth":2},
    {"id":"metrics_title","type":"text","x":60,"y":415,"width":300,"height":22,"text":"Data Quality & Lineage Metrics","fontSize":14,"fontFamily":3,"strokeColor":"#087f5b"},
    {"id":"metrics_content","type":"text","x":60,"y":445,"width":1530,"height":75,"text":"Layer           | Tables | Rows/Day    | Latency      | Quality Checks                              | Refresh\n----------------+--------+-------------+--------------+---------------------------------------------+--------------\nBronze          | 6      | ~20,000     | <5 min       | PyArrow schema validation                   | Event-driven\nSilver          | 6      | ~20,000     | +2 min       | ROW_NUMBER dedup, INNER JOIN FK validation  | 02:30 BRT daily\nGold            | 9      | ~20,000     | +5 min       | Row counts > 0, referential integrity       | 03:00 BRT daily\n----------------+--------+-------------+--------------+---------------------------------------------+--------------\nEnd-to-End SLA: POS upload -> Dashboard refresh < 8 hours (overnight batch) or < 5 min (intraday event-driven)","fontSize":9,"fontFamily":3,"strokeColor":"#495057"}
  ],
  "appState": {"viewBackgroundColor":"#ffffff","gridSize":null},
  "files": {
    "postgresql_logo": {
      "mimeType": "image/svg+xml",
      "id": "postgresql_logo",
      "dataURL": "data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjNDE2OUUxIiByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+UG9zdGdyZVNRTDwvdGl0bGU+PHBhdGggZD0iTTIzLjU1OTQgMTQuNzIyOGEuNTI2OS41MjY5IDAgMCAwLS4wNTYzLS4xMTkxYy0uMTM5LS4yNjMyLS40NzY4LS4zNDE4LTEuMDA3NC0uMjMyMS0xLjY1MzMuMzQxMS0yLjI5MzUuMTMxMi0yLjUyNTYtLjAxOTEgMS4zNDItMi4wNDgyIDIuNDQ1LTQuNTIyIDMuMDQxMS02LjgyOTcuMjcxNC0xLjA1MDcuNzk4Mi0zLjUyMzcuMTIyMi00LjczMTZhMS41NjQxIDEuNTY0MSAwIDAgMC0uMTUwOS0uMjM1QzIxLjY5MzEuOTA4NiAxOS44MDA3LjAyNDggMTcuNTA5OS4wMDA1Yy0xLjQ5NDctLjAxNTgtMi43NzA1LjM0NjEtMy4xMTYxLjQ3OTRhOS40NDkgOS40NDkgMCAwIDAtLjUxNTktLjA4MTYgOC4wNDQgOC4wNDQgMCAwIDAtMS4zMTE0LS4xMjc4Yy0xLjE4MjItLjAxODQtMi4yMDM4LjI2NDItMy4wNDk4Ljg0MDYtLjg1NzMtLjMyMTEtNC43ODg4LTEuNjQ1LTcuMjIxOS4wNzg4Qy45MzU5IDIuMTUyNi4zMDg2IDMuODczMy40MzAyIDYuMzA0M2MuMDQwOS44MTguNTA2OSAzLjMzNCAxLjI0MjMgNS43NDM2LjQ1OTggMS41MDY1LjkzODcgMi43MDE5IDEuNDMzNCAzLjU4Mi41NTMuOTk0MiAxLjEyNTkgMS41OTMzIDEuNzE0MyAxLjc4OTUuNDQ3NC4xNDkxIDEuMTMyNy4xNDQxIDEuODU4MS0uNzI3OS44MDEyLS45NjM1IDEuNTkwMy0xLjgyNTggMS45NDQ2LTIuMjA2OS40MzUxLjIzNTUuOTA2NC4zNjI1IDEuMzkuMzc3MmEuMDU2OS4wNTY5IDAgMCAwIC4wMDA0LjAwNDEgMTEuMDMxMiAxMS4wMzEyIDAgMCAwLS4yNDcyLjMwNTRjLS4zMzg5LjQzMDItLjQwOTQuNTE5Ny0xLjUwMDIuNzQ0My0uMzEwMi4wNjQtMS4xMzQ0LjIzMzktMS4xNDY0LjgxMTUtLjAwMjUuMTIyNC4wMzI5LjIzMDkuMDkxOS4zMjY4LjIyNjkuNDIzMS45MjE2LjYwOTcgMS4wMTUuNjMzMSAxLjMzNDUuMzMzNSAyLjUwNDQuMDkyIDMuMzcxNC0uNjc4Ny0uMDE3IDIuMjMxLjA3NzUgNC40MTc0LjM0NTQgNS4wODc0LjIyMTIuNTUyOS43NjE4IDEuOTA0NSAyLjQ2OTIgMS45MDQzLjI1MDUgMCAuNTI2My0uMDI5MS44Mjk2LS4wOTQxIDEuNzgxOS0uMzgyMSAyLjU1NTctMS4xNjk2IDIuODU1LTIuOTA1OS4xNTAzLS44NzA3LjQwMTYtMi44NzUzLjUzODgtNC4xMDEyLjAxNjktLjA3MDMuMDM1Ny0uMTIwNy4wNTctLjEzNjIuMDAwNy0uMDAwNS4wNjk3LS4wNDcxLjQyNzIuMDMwN2EuMzY3My4zNjczIDAgMCAwIC4wNDQzLjAwNjhsLjI1MzkuMDIyMy4wMTQ5LjAwMWMuODQ2OC4wMzg0IDEuOTExNC0uMTQyNiAyLjUzMTItLjQzMDguNjQzOC0uMjk4OCAxLjgwNTctMS4wMzIzIDEuNTk1MS0xLjY2OTh6Ii8+PC9zdmc+",
      "created": 1706745600000
    },
    "bigquery_logo": {
      "mimeType": "image/svg+xml",
      "id": "bigquery_logo",
      "dataURL": "data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjNDI4NUY0IiByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+R29vZ2xlIEJpZ1F1ZXJ5PC90aXRsZT48cGF0aCBkPSJNNS42NzYgMTAuNTk1aDIuMDUydjUuMjQ0YTUuODkyIDUuODkyIDAgMCAxLTIuMDUyLTIuMDg4di0zLjE1NnptMTguMTc5IDEwLjgzNmEuNTA0LjUwNCAwIDAgMSAwIC43MDhsLTEuNzE2IDEuNzE2YS41MDQuNTA0IDAgMCAxLS43MDggMGwtNC4yNDgtNC4yNDhhLjIwNi4yMDYgMCAwIDEtLjAwNy0uMDA3Yy0uMDItLjAyLS4wMjgtLjA0NS0uMDQzLS4wNjZhMTAuNzM2IDEwLjczNiAwIDAgMS02LjMzNCAyLjA2NUM0LjgzNSAyMS41OTkgMCAxNi43NjQgMCAxMC43OTlTNC44MzUgMCAxMC44IDBzMTAuNzk5IDQuODM1IDEwLjc5OSAxMC44YzAgMi4zNjktLjc3MiA0LjU1My0yLjA2NiA2LjMzMy4wMjUuMDE3LjA1Mi4wMjguMDc0LjA1bDQuMjQ4IDQuMjQ4em0tNS4wMjgtMTAuNjMyYTguMDE1IDguMDE1IDAgMSAwLTguMDI4IDguMDI4aC4wMjRhOC4wMTYgOC4wMTYgMCAwIDAgOC4wMDQtOC4wMjh6bS00Ljg2IDQuOThhNi4wMDIgNi4wMDIgMCAwIDAgMi4wNC0yLjE4NHYtMS43NjRoLTIuMDR2My45NDh6bS00LjUuOTQ4Yy40NDIuMDU3Ljg4Ny4wOCAxLjMzMi4wNzIuNC4wMjUuOC4wMjUgMS4yIDBWNy42OTJIOS40Njh2OS4wMzV6Ii8+PC9zdmc+",
      "created": 1706745600000
    }
  }
}
